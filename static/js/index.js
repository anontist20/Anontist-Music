var playlists = [
    {
        "name": "Energy 1",
        "songs": [{

            "name": "#1 - Power Surge",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/42f7e4c328f65fb78974c9a44d937602.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/1.mp3"

        },
        {

            "name": "#2 - Energetic Vibes",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/437696149df98a5070c94a21e0437942.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/2.mp3"

        },
        {

            "name": "#3 - Fuel the Fire",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/aaa918e69c12747e16132713cfdaf229.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/3.mp3"

        },
        {

            "name": "#4 - High Voltage",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/96ed3d783f0ae34dbaf5cbf0447a56a3.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/4.mp3"

        },
        {

            "name": "#5 - Electric Pulse",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/92192f31d616fcf2535f53a48914340b.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/5.mp3"

        },
        {

            "name": "#6 - Energy Overload",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/111a7e1af70eb7f0e9958eab423a5f51.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/6.mp3"

        },
        {

            "name": "#7 - Adrenaline Rush",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/32c54ce1d98334205d82ae334e62929b.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/7.mp3"

        },
        {

            "name": "#8 - Electro Drive",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/b0d6280c7f48283cd20d93545234c89e.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/8.mp3"

        },
        {

            "name": "#9 - Revitalized Beats",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/7b7560cc782a16f275b532c0085abc70.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/9.mp3"

        },
        {

            "name": "#10 - Energy Explosion",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/0c4deabc0d4f800e069140154612d6bb.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/10.mp3"

        },
        {

            "name": "#11 - Pumping Adrenaline",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/df64196c4fac73ac50269dd99bd82a55.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/11.mp3"

        },
        {

            "name": "#12 - Unleashed Energy",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/b1a53ca30cd9dd5da1b46cbdf7a62339.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/12.mp3"

        },
        {

            "name": "#13 - Rapid Fire",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/149e54ef0d598f07366f1aeba89dbc6e.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/13.mp3"

        },
        {

            "name": "#14 - Dynamic Rhythms",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/a9b685a2f973c0bb5fb8651da7dc1b75.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/14.mp3"

        },
        {

            "name": "#15 - Energy Storm",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/67ec8691b30154ce5a666b921896034d.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/15.mp3"

        },
        {

            "name": "#16 - Intensity Unleashed",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/8b7062b6b8cd111248f67980706710c4.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/16.mp3"

        },
        {

            "name": "#17 - Hyper Drive",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/8b27b808841a5c3c6e33e0b63b980977.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/17.mp3"

        },
        {

            "name": "#18 - Powerhouse Beats",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/ef730290b0b4c8ee3b1d3644780f4a20.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/18.mp3"

        },
        {

            "name": "#19 - Vibrant Surge",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/b63ea785f7741443740b879ca7fbba40.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/19.mp3"

        },
        {

            "name": "#20 - Elevated Momentum",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/8718ee654fbed860627ce89ce9b6d7a9.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/20.mp3"

        },
        {

            "name": "#21 - Electrocharged",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/de6ec24902754a88867163f349674fd0.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/21.mp3"

        },
        {

            "name": "#22 - Fueling the Groove",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/cc5b4b7191f1d90bddfc87301d406ac0.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/22.mp3"

        },
        {

            "name": "#23 - Energize the Flow",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/05ac1a6b33bf807885cc8dcb34a970ac.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/23.mp3"

        },
        {

            "name": "#24 - Electrifying Melodies",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/33bd7fa13844519946d2c31daf835b52.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/24.mp3"

        },
        {

            "name": "#25 - Revved Up Resonance",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/859024d2e994ca83a1a3870a738dcc0f.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/25.mp3"

        },
        {

            "name": "#26 - Pulsating Energy",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/fb807889e224371f02060776f8a37036.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/26.mp3"

        },
        {

            "name": "#27 - Epic Thrust",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/44c9842d6d12f0f13e3c2c4c8e47fe3c.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/27.mp3"

        },
        {

            "name": "#28 - Ignition Boost",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/8a9fcf1554596f37b68341836489ac9c.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/28.mp3"

        },
        {

            "name": "#29 - Frenetic Symphony",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/9088fa4dd5c7a43ee10c0d16cd93d602.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/29.mp3"

        },
        {

            "name": "#30 - Ultrasonic Drive",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/4f4916a71e22c35ea7065c0c2e795f79.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/30.mp3"

        },
        {

            "name": "#31 - Energized Pulse",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/3cfd94997f4698f3eef5655e0e5e771a.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/31.mp3"

        },
        {

            "name": "#32 - Dynamic Ignition",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/fc42f2835b3e388d0dba6db94356815f.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/32.mp3"

        },
        {

            "name": "#33 - Powerful Uprising",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/ab8ef19c7408a242e772d0d139676470.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/33.mp3"

        },
        {

            "name": "#34 - Sonic Burst",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/4167607e8df242e5b5deee003d0ac24d.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/34.mp3"

        },
        {

            "name": "#35 - Explosive Resonance",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/843ebecff2ff2a6d8f29a3698ea55741.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/35.mp3"

        },
        {

            "name": "#36 - Driven Beats",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/1df1d64a6a8f68230bf11fc5f205fc6f.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/36.mp3"

        },
        {

            "name": "#37 - Energetic Fusion",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/dd0d2a6f3d58adb25fbe0c74f40185a2.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/37.mp3"

        },
        {

            "name": "#38 - Radiant Revival",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/7364c5de9d2675a7408cb5cbe691a95a.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/38.mp3"

        },
        {

            "name": "#39 - Rhythmic Surge",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/d4133820960ee921748544354685c010.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/39.mp3"

        },
        {

            "name": "#40 - Electro Momentum",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/3bb739496060fd2c399bf147abb00901.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/40.mp3"

        },
        {

            "name": "#41 - Energetic Evolution",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/19131bb46485e93044dd614fd1d43a70.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/41.mp3"

        },
        {

            "name": "#42 - Accelerated Beats",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/69bb3c44960c01c3b2f16b5ce237dcb2.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/42.mp3"

        },
        {

            "name": "#43 - Vivid Vibrations",
            "banner-type": "url",
            "banner": "https://i.seadn.io/gcs/files/70f6d3298e01509099e8002dc932cbea.png?auto=format&dpr=1&w=3840",
            "songUrl": "/music/43.mp3"

        }
        ]
    }
    // Add more playlists here...
];

// do if page is loaded
document.addEventListener('DOMContentLoaded', function () {
    var playlistContainer = document.getElementById('playlistContainer');
    var backBtn = document.getElementById('backBtn');

    var playlistList = document.getElementById('playlistList');
    var songList = document.getElementById('songList');
    var playlistItems = document.getElementById('playlistItems');
    var songItems = document.getElementById('songItems');
    var audioPlayer = document.getElementById('audioPlayer');
    var progressBarFill = document.getElementById('progressBarFill');
    var bottomBar = document.querySelector('.bottom-bar');
    var playPauseBtn = document.getElementById('playPauseBtn');
    var stopBtn = document.getElementById('stopBtn');
    if (!localStorage.getItem("state")) {
        var state = "playlist";
    } else {
        var state = localStorage.getItem("state");
    }

    // Function to display playlists
    function displayPlaylists() {
        playlistItems.innerHTML = '';
        document.title = "Anontist Music";
        playlists.forEach(function (playlist, index) {
            var li = document.createElement('li');
            li.className = "playlistItemName";
            li.textContent = "👉 " + playlist.name;
            li.addEventListener('click', function () {
                displaySongs(index);
            });
            playlistItems.appendChild(li);
        });

        playlistList.style.display = 'block';
        songList.style.display = 'none';
        backBtn.style.display = 'none';
        bottomBar.style.display = 'none';
        audioPlayer.pause();
        audioPlayer.currentTime = 0;
        localStorage.setItem("state", "playlist");
    }

    // Function to display songs in a playlist
    function displaySongs(playlistIndex) {
        var playlist = playlists[playlistIndex];
        songItems.innerHTML = '';
        playlist.songs.forEach(function (song, index) {
            var li = document.createElement('li');
            li.innerHTML = "<img src='" + song.banner + "'> " + song.name;
            li.addEventListener('click', function () {
                localStorage.setItem("songIndex", index);
                playSong(song);
            });
            songItems.appendChild(li);
        });
        state = "songs";
        localStorage.setItem("state", "songs");
        localStorage.setItem("playlistIndex", playlistIndex);

        // set title
        document.title = playlist.name;

        playlistList.style.display = 'none';
        songList.style.display = 'block';
        backBtn.style.display = 'block';
        bottomBar.style.display = 'none';
        audioPlayer.pause();
        audioPlayer.currentTime = 0;
    }

    function playSong(song) {
        audioPlayer.src = song.songUrl;
        localStorage.setItem("song_src", JSON.stringify(song));

        // Update the song logo
        var songLogo = document.querySelector('.song-logo img');
        songLogo.src = song.banner;
        songLogo.alt = song.name;

        // update track name
        var trackTitle = document.getElementById('trackTitle');
        trackTitle.textContent = song.name;

        // set title

        document.title = song.name + " - " + playlists[parseInt(localStorage.getItem("playlistIndex"))].name;

        audioPlayer.play();
        bottomBar.style.display = 'block';
        playPauseBtn.innerHTML = "<i class=\"bi bi-pause\"></i>";

        state = "song_play";
        localStorage.setItem("state", state);
    }



    // Back button click event
    backBtn.addEventListener('click', function () {
        displayPlaylists();
    });

    // Play button click event
    playPauseBtn.addEventListener('click', function () {
        if (audioPlayer.paused) {
            playPauseBtn.innerHTML = "<i class=\"bi bi-pause\"></i>";
            audioPlayer.play();
        } else {
            playPauseBtn.innerHTML = "<i class=\"bi bi-play-fill\"></i>";
            audioPlayer.pause();
        }
    });

    // Stop button click event
    stopBtn.addEventListener('click', function () {
        audioPlayer.pause();
        audioPlayer.currentTime = 0;
        bottomBar.style.display = "none";
        state = "songs";
        localStorage.setItem("state", state);
        document.title = playlists[parseInt(localStorage.getItem("playlistIndex"))].name;
    });

    // Function to handle looping the current song
    function toggleLoop() {
        audioPlayer.loop = !audioPlayer.loop;
        loopBtn.innerHTML = audioPlayer.loop ? "Loop ✔️" : "Loop ❌";
    }

    // Loop button click event
    document.getElementById('loopBtn').addEventListener('click', function () {
        toggleLoop();
    });

    // play next song when the button is clicked
    document.getElementById("nextSong").addEventListener("click", function () {
        playNextSong();
    });

    // play previous song when button is clicked
    document.getElementById("previousSong").addEventListener("click", function () {
        playPreviousSong();
    });


    // Function to handle seeking forward or backward by a specified number of seconds
    function seekBySeconds(seconds) {
        var newTime = audioPlayer.currentTime + seconds;
        if (newTime < 0) {
            newTime = 0;
        } else if (newTime > audioPlayer.duration) {
            newTime = audioPlayer.duration;
        }
        audioPlayer.currentTime = newTime;
    }

    // Seek forward button click event
    document.getElementById('seekForwardBtn').addEventListener('click', function () {
        seekBySeconds(5); // Seek forward by 5 seconds
    });

    // Seek backward button click event
    document.getElementById('seekBackwardBtn').addEventListener('click', function () {
        seekBySeconds(-5); // Seek backward by 5 seconds
    });



    // Get the progress bar and its container
    var progressBar = document.querySelector('.progress-bar');
    var progressBarFill = document.querySelector('.progress-bar-fill');

    // Add a click event listener to the progress bar container
    progressBar.addEventListener('click', function (event) {
        var progressBarRect = progressBar.getBoundingClientRect();
        var progressBarWidth = progressBar.offsetWidth;
        var clickX = event.clientX - progressBarRect.left;
        var seekTime = (clickX / progressBarWidth) * audioPlayer.duration;
        audioPlayer.currentTime = seekTime;
    });

    // Function to play the next song in the playlist
    function playNextSong() {
        var playlistIndex = parseInt(localStorage.getItem("playlistIndex"));
        var playlist = playlists[playlistIndex];
        var songIndex = parseInt(localStorage.getItem("songIndex"));

        // Increment the songIndex to play the next song
        songIndex++;

        // Check if the songIndex exceeds the number of songs in the playlist
        if (songIndex >= playlist.songs.length) {
            // If the last song is reached, go to the first song in the playlist
            songIndex = 0;
        }

        // Store the updated songIndex in localStorage
        localStorage.setItem("songIndex", songIndex);

        // Play the next song
        var nextSong = playlist.songs[songIndex];
        playSong(nextSong);
    }

    // function to play previous song
    function playPreviousSong() {
        var playlistIndex = parseInt(localStorage.getItem("playlistIndex"));
        var songIndex = parseInt(localStorage.getItem("songIndex"));
        var playlist = playlists[playlistIndex];

        if (songIndex === 0) {
            console.log("0");
            // At the first song, go to the last song
            var lastSongIndex = playlist.songs.length - 1;
            var lastSong = playlist.songs[lastSongIndex];
            playSong(lastSong);

            // set song index in local storage
            localStorage.setItem("songIndex", lastSongIndex);
        } else {
            // Play the previous song
            var previousSongIndex = songIndex - 1;
            var previousSong = playlist.songs[previousSongIndex];
            playSong(previousSong);

            // set song index in local storage
            localStorage.setItem("songIndex", previousSongIndex);
        }
    }




    // Update progress bar and check if the current song has ended
    audioPlayer.addEventListener('timeupdate', function () {
        var progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        progressBarFill.style.width = progress + '%';

        // Check if the current song has ended
        if (audioPlayer.currentTime >= audioPlayer.duration) {
            // Play the next song
            playNextSong();
        }
    });


    // check the state, and then display the thing accordingly
    if (state == "playlist") {
        displayPlaylists();
    } else if (state == "songs") {
        displaySongs(parseInt(localStorage.getItem("playlistIndex")));
    } else if (state == "song_play") {
        displaySongs(parseInt(localStorage.getItem("playlistIndex")));
        playSong(JSON.parse(localStorage.getItem("song_src")));
        playPauseBtn.innerHTML = "<i class=\"bi bi-play\"></i>";
        audioPlayer.pause();
    }
});